{"id": "1", "text": "1. To verify that your Kaggle notebook works correctly before submitting it to run on the public1\nproblem set.", "expected": null}
{"id": "2", "text": "2. To familiarise you with the style and format of AIMO3 problems, including answer extraction\nconventions (note the move from 3 to 5 digits in the final answer) and the types of intermediate\ncalculations that may be required.", "expected": null}
{"id": "3", "text": "3. To provide a compact benchmark for preliminary testing of models. (Because of its small size,\nthis set is obviously not suitable for model training or fine-tuning.)\nBefore publication, we evaluated these problems using leading models available via API and ollama.\nSince these problems had never been exposed to any model before testing, the results represent\nuncontaminated performance. The results are shown on the next page.\nAbout the Problems\nWith the exception ofProblem 10, which adapts an existing problem, all problems in this reference\nset are entirely original and have not been publicly released before the launch of AIMO3.\nProblems 1–4are drawn from the AIMO2 benchmark. Each includes a brief remark summarising\nobserved results from the AIMO2 Kaggle competition, and for Problems 2 and 3, references to the\nOpenAIevaluationonthepublicAIMO2set(OpenAIxAIMOeval: Thegapisshrinking). Problems\n3 and 4 are taken from the private AIMO2 set which was not part of the OpenAI evaluation. The six-\nletter problem identifiers (eg “SWEETS”) correspond to those used in the linked analysis. Problem\n1 is deliberately straightforward—it is mainly intended as a quick check and should be solvable by\nany competent model.\nProblems 5–9 are challenging, novel problems designed to reflect the style and difficulty of the\nupcoming AIMO3 dataset. Their difficulty is intentionally higher than that of AIMO2 to ensure the\nproblems continue to challenge the strongest current open-source models.\nProblem 10is an adaptation of a problem from the International Mathematical Olympiad (IMO)\nShortlist. It illustrates the process of converting a traditional olympiad-style question into the\nanswer-only format used in AIMO. All problems in the AIMO public and private sets are fully\noriginal; we chose to adapt this one to preserve the hardest original material for the competition\ndatasets.\nAbout the Solutions\nSolutions are written for clarity rather than brevity. Where a result depends on a standard the-\norem or lemma, a brief reference is provided when possible. The goal is to make each argument\nstraightforward to follow, while acknowledging that the problems themselves are challenging. Only\none solution path is shown for each problem, though multiple valid approaches may exist.\n∗To cite these problems, please refer to the citation of the associated Kaggle competition.\n1Public is somewhat of a misnomer here as the problem set isnot publicly available. Instead, ‘public’ refers to\nthe problems being used for the public leaderboard on Kaggle.\n1\nModel Evaluation Results\nWe evaluated 14 leading language models on the 10-problem AIMO3 Reference Bench, including\nboth commercial APIs and open-weight models. The results reveal a significant performance gap\nthat AIMO3 aims to close.2\nThe strongest commercial models—GPT-5 Pro and GPT-5.1 (high)—solved all 10 problems, with\nGPT-5 (high), Grok-4, andGemini 2.5 Pro each solving 9 out of 10 (failing only on the hardest\nProblem 10). In contrast, most open-weight models struggled beyond the easier AIMO2 problems\n(Problems 1–4). The best-performing non-DeepSeek open-weight model,gpt-oss-120b, solved only\nthese four problems and none of the harder Problems 5–10.\nA notable exception isDeepSeek-v3.1-terminus (thinking), which matched the performance of\nsecond-tier commercial models by solving 9 out of 10 problems. However, this is a substantially\nlarger model (671B parameters) compared to other open-weight entries, and still falls short of the\ntop commercial systems on the hardest problem.\nCreating problems that challenge frontier models while working within AIMO’s format presents\na significant design challenge. The competition requires IMO-style problems with non-guessable\ninteger answers for automated evaluation. Most olympiad problems, however, are proof-based and\neither have no numerical answer at all, or have answers that are easily guessable (eg, small integers)\nor binary (yes/no). While challenging problems meeting AIMO’s criteria do exist, they are much\nharder to identify and create. Proof-based evaluation would open up significantly more options for\ndifficult olympiad problems, but remains challenging to implement in a scalable and reliable way.\nThe near-perfect performance of frontier commercial models on this reference set demonstrates\nwhat’s possible: closing this gap across the full 50-problem public set could yield scores in the high\n40s. This would represent a substantial leap from the mid-30s winning scores in AIMO1 and AIMO2,\nmarking a major milestone in open-source mathematical reasoning capabilities.\nClosing this gap is the core challenge of AIMO3. Can your submission demonstrate that open-weight\nmodels can match frontier commercial performance on advanced mathematical reasoning?\n2Model outputs are non-deterministic, so results may vary across runs. Additionally, models accessed via API\nmay be updated over time, potentially affecting performance.\n2\nProblem 1\nProblem: Alice and Bob are each holding some integer number of sweets. Alice says to Bob: “If\nwe each added the number of sweets we’re holding to our (positive integer) age, my answer would\nbe double yours. If we took the product, then my answer would be four times yours.” Bob replies:\n“Why don’t you give me five of your sweets because then both our sum and product would be equal.”\nWhat is the product of Alice and Bob’s ages?\nAnswer: 50\nSolution: Let Alice and Bob’s ages bexA and xB, respectively. After Alice gives Bob five sweets,\nlet Alice haveyA sweets and Bob haveyB sweets. We have\n(\nS = xA + yA = xB + yB\nP = xAyA = xByB\n.\nTheunorderedpairs {xA, yA} and{xB, yB} eachformthesetofrootsofthequadratic z2−Sz+P = 0.\nHence the sets are equal (possibly with the elements swapped). We consider the two cases.\nCase 1xA = xB = x, yA = yB = y\nBefore the exchange, Alice holdsy + 5 sweets and Boby − 5 so the conditions become\n(\n(x + y + 5) = 2(x + y − 5) =⇒ x + y = 15\nx(y + 5) = 4x(y − 5) =⇒ x(3y − 25) = 0 .\nThe second condition forces eitherx = 0 or 3y = 25, both of which violate the ages being positive\nintegers.\nCase 2xA = yB = x, yA = xB = y\nBefore the exchange, Alice holdsy + 5 sweets and Bobx − 5 so the conditions become:\n(\n(x + y + 5) = 2(x + y − 5) =⇒ x + y = 15\nx(y + 5) = 4y(x − 5) =⇒ 3xy − 20y − 5x = 0\n=⇒ 0 = 3x(15 − x) − 20(15 − x) − 5x = −3(x − 10)2 =⇒ x = 10.\nWe then havey = 15 − x = 5. It is easy to verify that if at the start, Alice is aged 10 and holds 10\nsweets and Bob is aged 5 and holds 5 sweets then the conditions are satisfied. Therefore, the answer\nwe report is5 × 10 = 50 .\nRemark: This problem was part of the AIMO2 private set (“SWEETS”) and was solved by approx-\nimately 85% of submissions, including all of the top 100. We include it as an example of a problem\nthat current models are expected to solve easily, which may assist in testing your model using the\nreference set on Kaggle. This problem is easier than any problem used in AIMO3, so the problems\nbelow should be used instead to give an indication of difficulty.\n3\nProblem 2\nProblem: A 500 × 500 square is divided intok rectangles, each having integer side lengths. Given\nthat no two of these rectangles have the same perimeter, the largest possible value ofk is K. What\nis the remainder whenK is divided by105?\nAnswer: 520\nSolution: Wefirstshowthatthesquarecanbedividedinto 520 rectanglessubjecttotheconstraints,\nand then prove that this is the maximum number possible.\nIn the bottom 249 rows, place 249 pairs of rectangles 1 × i and 1 × (500 − i) for i = 1, . . . ,249.\nThen, place a single1 × 500 rectangle in the row above to complete the bottom half. For the top\nhalf, place a1 × 250 rectangle vertically along the left side and then20 more horizontal rectangles\ni × 499 for i = 3, 4, . . . ,22 (note that3 + 4 +··· + 22 = 1\n2 · 22 · 23 − 3 = 250).\nThe rectangles in the bottom half have perimeters4, 6, . . . ,500, 504, 506, . . . ,1000, 1002 whilst the\nrectangles in the top half have perimeters502, 1004, 1006, . . . ,1042 so all these perimeters are dif-\nferent. In total we have placed(2 × 249) + 1 + 1 + 20 = 520rectangles proving the lower bound.\nTo show that520 is optimal, assume we can placek ≥ 521 rectangles subject to the constraint.\nFirst, note that the perimeters are all even integers and equal to2s where s is the semi-perimeter of\nthe rectangle. Ifthe two sides of the rectangle arex andy, thens = x+y and the area of the rectangle\nis A = xy = x(s − x). Since this is a downwards-pointing quadratic inx, A is minimised whenx\ntakes either its minimum or maximum value. Noting that1 ≤ x ≤ 500 and 1 ≤ y = s − x ≤ 500, we\nsee\nmax {1, s− 500} ≤x ≤ min {500, s− 1}.\nIf s ≤ 500, this bound is simply1 ≤ x ≤ s − 1 and we see both the minimum and maximum values\nfor x give A = s − 1 meaning thatA ≥ s − 1 whenever s ≤ 500.\nIf s ≥ 501, the bound becomess − 500 ≤ x ≤ 500 and we see both the minimum and maximum\nvalues forx give A = 500(s − 500) meaning thatA ≥ 500(s − 500) whenever s ≥ 501.\nDefine\nf(s) =\n(\ns − 1 1 ≤ s ≤ 500\n500(s − 500) s ≥ 501 .\nObserving that500 −1 = 499 < 500(501 −500), we see thatf(s) is an increasing function. Further-\nmore, the above shows a rectangle with semi-perimeters has areaA ≥ f(s).\nNow suppose the 521 rectangles have semi-perimeters 2 ≤ s1 < s2 < ··· < s521 and areas\nA1, . . . , A521. By considering the total area of the rectangles and using that f(s) is increasing,\nwe have\n5002 = A1 + ··· + A521 ≥ f(s1) + ··· + f(s521) ≥ f(2) + f(3) + ··· + f(522).\nWe can then calculate\n5002 ≥\n500X\ns=2\nf(s) +\n522X\ns=501\nf(s) =\n500X\ns=2\n(s − 1) +\n522X\ns=501\n500(s − 500) = 124,750 + 126,500 > 5002\nwhich is a contradiction.\nThus, 520 is indeed the optimal number of rectangles and this is the answer we report.\n4\nRemark 1:As this problem demonstrates, some answers are already smaller than the modulus for\nwhich the remainder is requested. In this case, the model should simply return the answer with no\nfurther calculations required.\nRemark 2: This problem was part of the AIMO2 public set (“RECTIL”) and was solved by only\na handful of the top 100 teams, and by none of the ultimate top 5. Interestingly, in the OpenAI\nx AIMO eval, the high compute run did not return the correct answer in its top response though\nlower compute runs did return the correct answer.\n5\nProblem 3\nProblem: Let ABC be an acute-angled triangle with integer side lengths andAB < AC. Points\nD and E lie on segmentsBC and AC, respectively, such thatAD = AE = AB. LineDE intersects\nAB at X. Circles BXD and CED intersect for the second time atY ̸= D. Suppose that Y lies\non lineAD. There is a unique such triangle with minimal perimeter. This triangle has side lengths\na = BC, b = CA, andc = AB. Find the remainder whenabc is divided by105.\nAnswer: 336\nSolution: As Y lies on lineAD, we seeA lies on lineDY which is the radical axis of circlesBXD\nand CED . We therefore haveAE · AC = AB · AX, which givesAX = AC since AE = AB. These\ntwo results together show pairs(B, E) and (X, C) are reflections across the bisector of∠BAC so D\nmust be the intersection of this bisector withBC. We can run this argument in reverse to see that\nD lying on the angle bisector is also a sufficient condition forY to lie on lineAD.\nA\nB\nD\nC\nE\nX Y\nIf we defineD′ as the intersection of the internal angle bisector of∠BAC with sideBC, the above\nshows thatY lies onAD if and only ifAD′ = AB (and thereforeD = D′).\nFrom angle bisector theorem, we haveBD′ = ac\nb+c and CD′ = ab\nb+c . Define d = AD′. We can apply\nStewart’s theorem to triangleABC with cevianAD to get\na · ac\nb + c · ab\nb + c + ad2 = b2 · ac\nb + c + c2 · ab\nb + c = abc =⇒ d2 = bc\n\u0000\n(b + c)2 − a2\u0001\n(b + c)2 .\nAD′ = AB is equivalent tod = c which we can express as\nc2 = bc\n\u0000\n(b + c)2 − a2\u0001\n(b + c)2 ⇐⇒\n\u0012 a\nb + c\n\u00132\n= b − c\nb .\nWe are told thata, b, care positive integers withc < b. We want to find the minimum such values\nthat are the sides of a triangle and satisfy these conditions.\n6\nWrite g = gcd(b, c) and b = gb′, c = gc′ where gcd(b′, c′) = 1. The above then becomes\n··· ⇐⇒\n\u0012 a\ng (b′ + c′)\n\u00132\n= b′ − c′\nb′ .\nSince the numerator and denominator are coprime and positive, we must haveb′ − c′ = y2 and\nb′ = x2 for coprime positive integersx and y with x > ythen\n··· =⇒ a\ng (2x2 − y2) = y\nx =⇒ a = gy\n\u0000\n2x2 − y2\u0001\nx .\nNote thatgcd\n\u0000\n2x2 − y2, x\n\u0001\n= gcd\n\u0000\ny2, x\n\u0001\n= 1 so, fora to be an integer, we must havex | g. Write\ng = kx for a positive integerk. We can then summarise the solutions as\n(a, b, c) =\n\u0000\nky\n\u0000\n2x2 − y2\u0001\n, kx3, kx\n\u0000\nx2 − y2\u0001\u0001\n. (■)\nTriangle inequality is equivalent to:\nb + c > a⇐⇒ (x − y)\n\u0000\n2x2 − y2\u0001\n> 0\na + c > b⇐⇒ y\n\u0000\n2x2 − xy − y2\u0001\n> 0\na + b > c⇐⇒ y(x + y)(2x − y) > 0.\nThese will always be satisfied for coprime positive integersx and y with x > y. We can also check\nb > c⇐⇒ x2 > x\n\u0000\nx2 − y2\u0001\n⇐⇒ xy2 > 0\nwhich will be satisfied forx, y≥ 1.\nLastly, note that all the steps above are reversible so the family given in (■) exactly characterises\ntriangles with the desired property.\nWhat remains is to find the triangle with minimal perimeter. Sincek simply scales the perimeter,\nwe must havek = 1 for the triangle with minimal perimeter and then\na + b + c = y\n\u0000\n2x2 − y2\u0001\n+ x2 + x\n\u0000\nx2 − y2\u0001\n= (x + y)\n\u0000\n2x2 − y2\u0001\n.\nThis is an increasing function ofx so to minimise the perimeter, we will choosex = y + 1 (which\nmeans x and y will be coprime). The above becomes\n··· = (2y + 1)\n\u0000\ny2 + 4y + 2\n\u0001\nwhich is an increasing function ofy so is minimised aty = 1.\nThe pairx = 2, y = 1 corresponds to(a, b, c) = (7, 8, 6) which has all of the required properties (the\ntriangle is acute since82 < 72 + 62). The answer we report is\n7 × 8 × 6 = 336 .\nRemark: This problem was also part of the AIMO2 public set (“MINPER”) and was again solved\nby only a handful of the top 100 teams, and by none of the ultimate top 5. This problem was solved\nin the OpenAI x AIMO eval by all compute levels.\n7\nProblem 4\nProblem: Let f : Z≥1 → Z≥1 be a function such that for all positive integersm and n,\nf(m) + f(n) = f(m + n + mn).\nAcross all functionsf such thatf(n) ≤ 1000 for alln ≤ 1000, how many different values canf(2024)\ntake?\nAnswer: 580\nSolution: Let Z≥2 = {2, 3, . . .} be the set of positive integers greater than or equal to2. Define a\nfunction g : Z≥2 → Z≥1 by g(n) = f(n − 1) for n ≥ 2. From the given relation forf we have, for\nn, m≥ 2,\ng(m) +g(n) = f(m −1) +f(n −1) = f(m −1 +n −1 + (m −1)(n −1)) = f(mn −1) = g(mn). (∗)\nRepeatedly applying (∗), we see that ifn = pα1\n1 ··· pαk\nk is the prime factorisation ofn ≥ 2 then\ng(n) = g(pα1\n1 ) + ··· + g(pαk\nk ) = α1 · g(p1) + ··· + αk · g(pk). (▲)\nWe havef(2024) = g(2025) and the prime factorisation of2025 is 2025 = 34 · 52 so\nf(2024) = g(2025) = 4g(3) + 2g(5).\nWe are left to consider the possible values for the above quantity subject to the condition that\ng(n) = f(n − 1) ≤ 1000 for 2 ≤ n ≤ 1001.\nClaim: 1 ≤ g(3) ≤ 166 and 1 ≤ g(5) ≤ 250. For each choice ofg(3) and g(5) in these ranges, we\ncan construct a functiong satisfying (∗).\nProof. Firstly, from (▲), we have\n1000 ≥ g(729) = g\n\u0000\n36\u0001\n= 6g(3) =⇒ g(3) ≤\n\u00161000\n6\n\u0017\n= 166\n1000 ≥ g(625) = g\n\u0000\n54\u0001\n= 4g(5) =⇒ g(5) ≤\n\u00161000\n4\n\u0017\n= 250\nwhich proves the bounds.\nNext, let1 ≤ s ≤ 166 and 1 ≤ t ≤ 250. For a positive integern ≥ 2, letn = 3α · 5β · pγ1\n1 ··· pγk\nk be\nits prime factorisation withpi ̸= 3, 5 and possibly withα or β being 0. Define a functiong by\ng(n) = g\n\u0000\n3α · 5β · pγ1\n1 ··· pγk\nk\n\u0001\n= αs + βt + γ1 + ··· + γk.\nThis can easily be seen to satisfy (∗) and also hasg(3) = s, g(5) = t.\nLet n ≤ 1001, it remains to checkg(n) ≤ 1000. Define γ = γ1 + ··· + γk then\n1001 ≥ n ≥ 2γ · 3α · 5β and g(n) = αs + βt + γ ≤ 166α + 250β + γ. (■)\nWe now consider the possible values forβ. Since 5β ≤ n ≤ 1001, we have0 ≤ β ≤ 4.\n• β = 4: Since 54 = 625, (■) forcesα = γ = 0 so g(n) ≤ 250 × 4 = 1000.\n8\n• β = 3: Similarly,53 = 125 so from (■), α ≤ 1 and γ ≤ 3 so\ng(n) ≤ 166 × 1 + 250× 3 + 3 = 919 ≤ 1000.\n• β = 2: If α = 3, then1001 ≥ n = 2γ · 33 · 52 = 675 · 2γ so γ = 0. From (■),\ng(n) ≤ 3 × 166 + 2× 250 + 0 = 998 ≤ 1000.\nOtherwise, α ≤ 2 and, asγ ≤ 5,\ng(n) ≤ 166 × 2 + 250× 2 + 5 = 837 ≤ 1000.\n• β = 1: 51 = 5 and from (■), α ≤ 4, γ ≤ 7 so\ng(n) ≤ 166 × 4 + 250× 1 + 7 = 921 ≤ 1000.\n• β = 0: If α = 6, then γ = 0 and g(n) ≤ 6 × 166 = 996 ≤ 1000. Otherwise, α ≤ 5 and also\nγ ≤ 9 leading to\ng(n) ≤ 166 × 5 + 250× 0 + 9 = 839 ≤ 1000.\nIn any case, we see the condition ong will be satisfied so we can reverse the process to get a valid\nfunction f.\nFrom the Claim, we havef(2024) = 4s + 2t = 2(2s + t) with 1 ≤ s ≤ 166 and 1 ≤ t ≤ 250. (2s + t)\ncan take any value between3 and 250 + 2 × 166 = 582 and f(2024) is equal to double this so, in\ntotal, there are582 − 3 + 1 = 580 possible values which is the answer we report.\nRemark: This problem was part of the AIMO2 private set (“FUNVAL”) and was solved by about\n2% of all submissions, including roughly 20% of the top 100 (though not all of the top 5). This\nhighlights the trade-offs made by top-ranking models, which may fail to solve certain problems that\na larger fraction of lower-ranked models can, yet they still achieve higher overall performance.\n9\nProblem 5\nProblem: A tournament is held with220 runners each of which has a different running speed. In\neach race, two runners compete against each other with the faster runner always winning the race.\nThe competition consists of20 rounds with each runner starting with a score of0. In each round,\nthe runners are paired in such a way that in each pair, both runners have the same score at the\nbeginning of the round. The winner of each race in theith round receives220−i points and the loser\ngets no points.\nAt the end of the tournament, we rank the competitors according to their scores. LetN denote the\nnumber of possible orderings of the competitors at the end of the tournament. Letk be the largest\npositive integer such that10k divides N. What is the remainder whenk is divided by105?\nAnswer: 21818\nSolution: Since the points received in a given round are strictly greater than the points available\nin all subsequent rounds (from2k > 2k − 1 = 2k−1 + 2k−2 + ··· + 1), each runner must be paired\nwith another runner with an identical win/loss record in the preceding rounds (so they have the\nsame score). Thus, in roundi there are2i−1 groups (based on the possible win/loss sequences in the\nprevious i − 1 rounds) each consisting of221−i runners. Also, a runner’s (ordered) win/loss record\nacross the rounds uniquely determines their final position by uniqueness of binary expansions.\nConsider a group with the same score in a particular round and let there be2n runners in that group.\nWe need to count the number of valid ways to choosen winners from these2n runners. Label the\nrunners from1 (fastest) to2n (slowest), and record the outcome of each race in a left-to-right string\nof parentheses, where:\n• ( indicates that runner wins the race,\n• ) indicates that runner loses.\nIn a valid string, each( must match with a later), corresponding to a race between a faster and\nslower runner. For example, whenn = 3, the string(()()) represents the matches:1 beats 6, 2 beats\n3, and4 beats 5.\nIt is well-known that the number of such valid parenthesis strings is thenth Catalan number\nCn = 1\nn + 1\n\u00122n\nn\n\u0013\n= (2n)!\nn!(n + 1)!.\nNow in roundi, we have2i−1 groups each consisting of221−i runners. By the above, there are\n\u0010\nC220−i\n\u00112i−1\n=\n \u0000\n221−i\u0001\n!\n(220−i)! (220−i + 1)!\n!2i−1\nways to choose the winners in this round. Since each choice of winners across the different groups\nwill lead to a different final position (by the comment at the top about the win/loss records uniquely\ndetermining the final position), the number of possible orderings is equal to the product of the above\n10\nquantity over the rounds1 ≤ i ≤ 20 which is\nN =\n20Y\ni=1\n \u0000\n221−i\u0001\n!\n(220−i)! (220−i + 1)!\n!2i−1\n=\n20Y\ni=1\n1\n(220−i + 1)2i−1 ·\n\u0000\u0000\n221−i\u0001\n!\n\u00012i−1\n((220−i)!)2i\n=\n\" 20Y\ni=1\n1\n(220−i + 1)2i−1\n#\n·\n\u0000\u0000\n220\u0001\n!\n\u000120\n((219)!)21 ·\n\u0000\u0000\n219\u0001\n!\n\u000121\n((218)!)22 ···\n\u0000\u0000\n21\u0001\n!\n\u0001219\n((20)!)220\n=\n\u0000\n220\u0001\n! ·\n20Y\ni=1\n1\n(220−i + 1)2i−1\nWe are then left to determine the highest power of10 dividing N. Applying Legendre’s Formula,\nwe can compute the highest power of2 and 5 dividing\n\u0000\n220\u0001\n! as\nν2\n\u0000\u0000\n220\u0001\n!\n\u0001\n=\n∞X\nk=1\n\u0016220\n2k\n\u0017\n= 219 + 218 + ··· + 21 + 20 = 220 − 1\nν5\n\u0000\u0000\n220\u0001\n!\n\u0001\n=\n∞X\nk=1\n\u0016220\n5k\n\u0017\n=\n\u0016220\n5\n\u0017\n+\n\u0016220\n52\n\u0017\n+ ··· +\n\u0016220\n58\n\u0017\n= 262,140 .\nWe can also see that all the terms in the denominator in the expression forN are odd except the\nfinal one fori = 20. Thus,\nν2(N) =\n\u0000\n220 − 1\n\u0001\n− ν2\n\u0010\n2220−1 \u0011\n=\n\u0000\n220 − 1\n\u0001\n− 219 = 219 − 1 .\nSince powers of2 cycle with period4 modulo 5, we have that220−i + 1 will be divisible by5 if and\nonly if20 − i ≡ 2 mod 4 which is equivalent toi = 4k + 2 for some non-negative integerk. In this\ncase, we can write\n220−i + 1 = 220−(4k+2) + 1 = 22(9−2k) + 1 = 49−2k + 1.\nWe can apply the Lifting the Exponent Lemma (or just directly compute given the small number of\npossibilities fork) that\nν5\n\u0000\n49−2k + 1\n\u0001\n= ν5(4 + 1) +ν5(9 − 2k) = 1 + ν5(9 − 2k) =\n(\n1 k ∈ {0, 1, 3, 4}\n2 k = 2 .\nNow introducing the powers in the denominator, we get\nν5\n 20Y\ni=1\n\u0000\n220−i + 1\n\u00012i−1\n!\n= 22−1 + 26−1 + 210−1 · 2 + 214−1 + 218−1 = 140,322 .\nThus,\nν5(N) = 262,140 − 140,322 = 121,818 .\nTo get a factor of10 in N, we must have a factor of2 and a factor of5. Noting that 219 − 1 =\n524,287 > 121,818, we see that factors of5 are the limiting ones. We therefore have\nk = ν5(N) = 121,818 ≡ 21818 (mod 105)\nwhich is the answer we report.\n11\nProblem 6\nProblem: Define a functionf : Z≥1 → Z≥1 by\nf(n) =\nnX\ni=1\nnX\nj=1\nj1024\n\u00161\nj + n − i\nn\n\u0017\n.\nLet M = 2 · 3 · 5 · 7 · 11 · 13 and letN = f\n\u0000\nM15\u0001\n− f\n\u0000\nM15 − 1\n\u0001\n. Let k be the largest non-negative\ninteger such that2k divides N. What is the remainder when2k is divided by57?\nAnswer: 32951\nSolution: We make use of two identities. Defineσk(n) = P\nd|n\ndk.\nClaim 1:(Hermite’s Identity). For anyx ∈ R and positive integern, we have\nnX\ni=1\n\u0016\nx + n − i\nn\n\u0017\n= ⌊nx⌋.\nProof. Let\nd(x) = ⌊nx⌋ −\nnX\ni=1\n\u0016\nx + n − i\nn\n\u0017\n.\nThen,\nd\n\u0012\nx + 1\nn\n\u0013\n= ⌊nx + 1⌋ −\nnX\ni=1\n\u0016\nx + n + 1 − i\nn\n\u0017\n= ⌊nx⌋ + 1 −\n nX\ni=1\n\u0016\nx + n − i\nn\n\u0017!\n− 1 = d(x),\nhence d is periodic with period1\nn . Since all floors are 0 forx ∈\n\u0002\n0, 1\nn\n\u0001\n, this givesd ≡ 0 in general.\nClaim 2:For any positive integern,\nnX\nj=1\nσk(j) =\nnX\nd=1\ndk\njn\nd\nk\n. (■)\nProof. We count\nS =\nnX\nj=1\nX\nd|j\ndk\nin two ways. TheLHS of (■) comes from the definition ofσk.\nFor d = 1, 2, . . . , n, we have\n\u0004n\nd\n\u0005\nmultiples ofd at mostn, hence this is the number of timesdk is\nsummed. This gives theRHS of (■). Thus, both sides of (■) are equal toS so in particular, are\nequal to each other.\nFlipping the order of summation inf, we have\nf(n) =\nnX\nj=1\nj1024\nnX\ni=1\n\u00161\nj + n − i\nn\n\u0017\nClaim 1\n=\nnX\nj=1\nj1024\n\u0016n\nj\n\u0017\nClaim 2\n=\nnX\nj=1\nσ1024(j).\n12\nWe therefore have\nN = f\n\u0000\nM15\u0001\n− f\n\u0000\nM15 − 1\n\u0001\n= σ1024\n\u0000\nM15\u0001\n.\nDefine P = {2, 3, 5, 7, 11, 13} so M = Q\np∈P\np. By considering the possibilities for the prime factorisa-\ntion ofd in the definition ofσ1024 and raising these to the power ofk we get\nN = σ1024\n\u0000\nM15\u0001\n=\nY\np∈P\n\u0000\n1 + p1024 + p2·1024 + ··· + p15·1024\u0001\n=\nY\np∈P\np16·1024 − 1\np1024 − 1 .\nWe want to count the number of factors of2 in this expression. Forp = 2, the expression will be\nodd so it suffices to consider the oddp. We apply the Lifting the Exponent Lemma in the even\npower case to get\nν2\n\u0010\u0000\np1024\u000116\n− 1\n\u0011\n− ν2\n\u0000\np1024 − 1\n\u0001\n= ν2\n\u0000\np1024 + 1\n\u0001\n+ ν2(16) − 1 = 1 + 4− 1 = 4.\nwhere we have usedp2 ≡ 1 mod 4 for all oddp so p1024 + 1 ≡ 2 mod 4 is divisible by2 but not4.\nSince there are5 odd elements ofP, we get\nk = ν2(N) = 5 · 4 = 20.\nLastly, we compute\n2k = 220 ≡ 32951 (mod 57)\nwhich is the answer we report.\nRemark: The choice of57 as the modulus in this problem is intended to emphasise that models\nshould be able to handle a variety of moduli—not just105 or 99991 which are the most commonly\nused (the latter is used when a prime modulus is desirable). For AIMO3, all problem statements\nhave the modulus included explicitly (unlike for AIMO1 and AIMO2 where there was an implicit\nstep of taking your answer modulo 1000).\n13\nProblem 7\nProblem: Let ABC be a triangle withAB ̸= AC, circumcircleΩ, and incircleω. Let the contact\npoints ofω with BC, CA, andAB be D, E, andF, respectively. Let the circumcircle ofAF Emeet\nΩ at K and let the reflection ofK in EF be K′. LetN denote the foot of the perpendicular fromD\nto EF . The circle tangent to lineBN and passing throughB and K intersects BC again atT ̸= B.\nLet sequence(Fn)n≥0 be defined byF0 = 0, F1 = 1 and forn ≥ 2, Fn = Fn−1 + Fn−2. Call ABC\nn-tastic if BD = Fn, CD = Fn+1, andKNK ′B is cyclic. Across alln-tastic triangles, letan denote\nthe maximum possible value ofCT ·NB\nBT ·NE . Let α denote the smallest real number such that for all\nsufficiently largen, a2n < α. Given that α = p + √q for rationalsp and q, what is the remainder\nwhen\n\u0004\npqp \u0005\nis divided by99991?\nAnswer: 57447\nSolution: We assumeAB < ACsince alln-tastic triangles have this property and that is where we\nare working towards. For now however, we consider all triangles with this property and will impose\nthe n-tastic condition later.\nA\nB CD\nE\nF\nK\nK′\nNσ\nΓ\nΣ\nP\nT′\nP′\nDenote circleKNK ′ and KND by σ and Σ, respectively. LetEF intersect BC at T′. Next, letσ\nand Σ intersect lineBN again atP ̸= N and P′ ̸= N, respectively.\n14\nFromitsdefinition, K isthecentreofspiralsimilaritytaking F E→ BC. Denotethisspiralsimilarity\nby f so f(F) = B, f(E) = C, andf(K) = K. We recall some well-known results:\n• K is also the centre of spiral similarity takingBF → CE.\n• T′BF Kis cyclic—denote this circle byΓ.\nClaim 1:f(N) = D.\nProof. This is a well-known result but for completeness, we provide a proof.\nFirstly, recall that linesAD, BE, and CF concur at the Gergonne point of triangleABC. Thus,\nwe can apply Ceva’s and Menelaus’s theorem to get\nBT ′\nT′C\nMenelaus\n= −AE\nEC · BF\nF A\nCeva\n= −BD\nDC\nwhere we are using directed lengths so if a point lies outside the segment, the ratio is negative. This\nmeans that(B, C; T′, D) = −1 where the term in brackets denotes the cross ratio of the four points.\nWe have∠T′ND = 90◦ and it is well-known (eg see here) that these two properties combined imply\nthat ND and T′N bisect ∠BNC (internally and externally, respectively).\nFrom this, we get∠F NB= ∠CNE . Since AE = AF, ∠AEF = ∠EFA which implies∠BF N=\n∠NEC . Combining these two results shows triangleBF Nand CEN are similar hence\nF N\nNE = BF\nCE = BD\nDC\nwhere we have used thatBF and BD are both tangents fromB to the incircle so have equal length,\nand similarly forC.\nSince f(F E) = BC and N and D split these segments in the same ratio, the claim follows.\nA consequence of Claim 1 and properties of spiral similarities is thatΣ passes through T′. Since\n∠T′ND = 90◦, this also showsΣ has diameterT′D.\nClaim 2:P lies onΓ.\nProof. Firstly, note thatσ is uniquely defined as the circle passing throughK and N that has centre\non lineEF (which is equivalent toσ passing throughK′). Applying the transformationf, we see\nf(σ) is uniquely defined as the circle passing throughf(K) = K and f(N) = D (Claim 1) that has\ncentre on linef(EF ) = BC. But from the comment above, this precisely definesΣ, thusf(σ) = Σ.\nNext, we see that\n∠F NP= ∠T′NP ′ = ∠T′DP ′ = ∠BDP ′.\nSince f(F N) = BD and f(σ) = Σ, this showsf(P) = P′. Thus,\n∠F P K= ∠f(F)f(P)f(K) = ∠BP ′K = ∠NP ′K = ∠NT ′K = ∠F T′K\nwhich shows thatP lies on circleF T′K ie Γ.\n15\nClaim 3:For ann-tastic triangle,T = T′ and BNEC is cyclic.\nProof. For these trianglesB lies onσ so we must in fact haveP = B. It then follows (by considering\nP moving towardsB along line BN ) that Γ is tangent toBN at B. Since Γ also passes through\nK, this must be the circle described at the bottom of the first paragraph in the question. SinceΓ\nintersects BC again atT′ ̸= B, the first part of the claim follows.\nFor the second part, applying the alternate segment theorem using the tangency ofΓ to BN we get\n∠CBN = ∠T BP′ = ∠T F B= ∠EF A= ∠AEF = 180◦ − ∠NEC\nwhich proves thatBNEC is cyclic.\nA\nB = P CD\nE\nF\nK\nK′\nN\nT = T′\nWe now considern-tastic triangles and useT and T′ interchangeably since they are the same point.\nRecalling from Claim 1 that trianglesBF Nand CEN are similar and then using Claim 3 we get\n∠EBN = ∠ECN = ∠NBF = ∠BT N\nwhere in the last step we used thatBN is tangent toΓ. We also have\n∠CBE = ∠CNE = ∠F NB= 180◦ − ∠BNE = ∠ECB\nso EC = EB.\nApplying the sine rule to trianglesEBN and ET B, we get\nNB\nNE = sin ∠NEB\nsin ∠EBN = sin ∠T EB\nsin ∠BT E= BT\nBE = BT\nCE = BT\nCD .\nWe can use this to rewrite the target expression in the question as\nCT · NB\nBT · NE = CT\nBT · BT\nCD = CT\nCD .\n16\nWe are told that BD = Fn and CD = Fn+1 so BC = BD + CD = Fn+2. Returning to the\ncalculations in Claim 1 (and this time using undirected lengths), we have\nCD\nBD = Fn+1\nFn\n= CT\nBT = CT\nCT − BC = CT\nCT − Fn+2\n=⇒ CT = Fn+1Fn+2\nFn−1\n.\nThis allows us to write (noting that the quantity in the question is constant across alln-tastic\ntriangles)\nan = CT · NB\nBT · NE = CT\nCD = Fn+2\nFn−1\n.\nLet φ = (1 +\n√\n5)/2 be the golden ratio. Using Binet’s formula, we can write\nan = φn+2 − (−φ)−(n+2)\nφn−1 − (−φ)−(n−1) .\nNow specialising ton even, we have\na2n = φ2n+2 − φ−(2n+2)\nφ2n−1 + φ−(2n−1) = φ3 · 1 − φ−4n−4\n1 + φ−4n+2\n| {z }\n(∗)\n< φ3.\nSince φ >1, we have(∗) → 1\n1 = 1 as n → ∞, thus the smallest real numberα with the desired\nproperty isφ3. We can compute\nφ3 = 2 +\n√\n5 =⇒ p = 2 , q= 5\nso the answer we report is\n252\n= 33554432 ≡ 57447 (mod 99991).\nRemark: Because of the problem’s conditional structure—and that it concerns a family of triangles\nrather than one specific configuration—brute-force approaches that attempt to construct one or\nmore diagrams and compute all lengths numerically are unlikely to succeed.\n17\nProblem 8\nProblem: On a blackboard, Ken starts off by writing a positive integern and then applies the\nfollowing move until he first reaches1. Given that the number on the board ism, he chooses a base\nb, where2 ≤ b ≤ m, and considers the unique base-b representation ofm,\nm =\n∞X\nk=0\nak · bk\nwhere ak are non-negative integers and0 ≤ ak < bfor eachk. Ken then erasesm on the blackboard\nand replaces it with\n∞P\nk=0\nak.\nAcross all choices of1 ≤ n ≤ 10105\n, the largest possible number of moves Ken could make isM.\nWhat is the remainder whenM is divided by105?\nAnswer: 32193\nSolution: Consider the directed graphG with positive integers as vertices and a directed edge from\nn to every output of a move fromn. We completely determineG.\nClaim 1:The outgoing neighbours ofn are exactly{⌈n/2⌉, ⌈n/2⌉ −1, . . . ,2, 1}.\nProof. These are achievable by bases ⌊n/2⌋ + 1, ⌊n/2⌋ + 2, . . . , n, respectively since for a base\n⌊n/2⌋ + 1 ≤ b ≤ n, n has two digits in base-b, 1 and n − b, so the digit sum isn + 1 − b.\nNext we show that there are no other neighbours. Equivalently, we need to prove that if there is an\nedge fromn to r (that is, if for some baseb with 2 ≤ b ≤ n the sum of the base-b digits ofn equals\nr), thenr ≤ ⌈n/2⌉. We can verify this directly forn ≤ 10, so henceforth assumen >10.\nConsider n in base-b, where2 ≤ b < n. Since we wish to maximise the sum of the base-b digits, we\ncan replacebk with b copies ofbk−1 as this will always increase the sum of the digits. Repeating this\nprocess for all powersbk for k ≥ 2, we reducen to having only2 base-b digits, the largest of which\nmust be⌊n/b⌋ so we can write\nn =\njn\nb\nk\nb +\n\u0010\nn − b\njn\nb\nk\u0011\n.\nThus, in general\nr = Sum of base-b digits ofn ≤\njn\nb\nk\n+\n\u0010\nn − b\njn\nb\nk\u0011\n=\njn\nb\nk\n+ (n mod b)\nwhere the final term should take the remainder in the range0 to b − 1.\nForb = 2, this gives⌈n/2⌉.\nFor3 ≤ b ≤ ⌊n/2⌋ −2, we have the bound\nr ≤\njn\nb\nk\n+ (n mod b) ≤ n\nb + b − 1.\nFor fixedn, considerf(b) = (n/b) + b. Since\nf(b + 1) − f(b) = − n\nb(b + 1) + 1,\n18\nf will be decreasing up to a certain value (possibly no values) and then will be increasing from that\npoint on. This meansf(b) will be maximised at an endpoint. By rearranging, we have\nf(3) = (n/3) + 3 ≤ ⌈n/2⌉ + 1 ⇐⇒\n(\nn ≥ 12 n even\nn ≥ 9 n odd\nwhich are both true sincen >10.\nForb = ⌊n/2⌋ −2, we have\nf(⌊n/2⌋ −2) = n\n⌊n/2⌋ −2 + ⌊n/2⌋ −2 ≤ ⌈n/2⌉ + 1 ⇐⇒\n(\nn ≥ 12 n even\nn ≥ 10 n odd\nwhich are both true sincen >10. Thus, we have shownf(b) ≤ ⌈n/2⌉ + 1 for b in the given range\nmeaning\nr ≤ f(b) − 1 ≤ ⌈n/2⌉\nas desired.\nWe are left to consider⌊n/2⌋ −1 ≤ b ≤ n.\nFor⌊n/2⌋ −1 ≤ b ≤ ⌊n/2⌋, n in base-b will have two digits, the first being a2 and the second being\n0, 1, 2, or3. Thus the sum of the digits is≤ 5 ≤ ⌈n/2⌉ (since n >10).\nFor⌊n/2⌋ + 1 ≤ b ≤ n, n in base-b will be two digits, the first of which is1 and the second of which\nis n − b. Thus,\nr = 1 + (n − b) ≤ n + 1 − (⌊n/2⌋ + 1) = n − ⌊n/2⌋ = ⌈n/2⌉\nsince b ≥ ⌊n/2⌋ + 1. This completes the proof.\nClaim 2:The length of the longest path fromn to 1 has length⌈log2(n)⌉.\nProof. Note that a move strictly decreases the value on the blackboard. Letf(n) denote the length\nof the longest path fromn to 1 inG. By considering the first move and using Claim 1, we get\nf(n) = 1 + max{f(⌈n/2⌉), f(⌈n/2⌉ −1), . . . , f(2), f(1)}.\nThis Claim then follows by induction, using⌈log2(2n + 1)⌉ = ⌈log2(2n)⌉ = 1 + ⌈log2(n)⌉ for n ≥ 1\nsince 2n + 1 is not a power of 2.\nThus, we extract the answer\nl\nlog2\n\u0010\n10105 \u0011m\n=\n\u0006\n105 · log2 (10)\n\u0007\n= 332193 ≡ 32193 (mod 105)\nwhich is the number we report.\nRemark: In order to prevent direct enumeration approaches, many of the numbers that appear in\nproblems for AIMO3 are very large. We expect models to be able to handle calculations such as the\nabove when calculating answers.\n19\nProblem 9\nProblem: Let F be the set of functionsα: Z → Z for which there are only finitely manyn ∈ Z\nsuch thatα(n) ̸= 0.\nFor two functionsα and β in F, define their productα ⋆ βto be P\nn∈Z\nα(n) · β(n). Also, for n ∈ Z,\ndefine a shift operatorSn : F → Fby Sn(α)(t) = α(t + n) for allt ∈ Z.\nA functionα ∈ Fis calledshifty if\n• α(m) = 0 for all integersm <0 and m >8 and\n• There existsβ ∈ Fand integersk ̸= l such that for alln ∈ Z\nSn(α) ⋆ β=\n(\n1 n ∈ {k, l}\n0 n ̸∈ {k, l} .\nHow many shifty functions are there inF?\nAnswer: 160\nSolution: Forα ∈ F, we define two functions\nPα(x) =\nX\nk∈Z\nα(k) · xk Qα(x) =\nX\nk∈Z\nα(k) · x−k.\nThe conditions onF ensure that both sums only have finitely many non-zero terms and soPα is\na polynomial of degree at most8 and Qα is a finite Laurent polynomial (an extension of a normal\npolynomial to include negative powers ofx).\nLet α ∈ Fbe shifty and letβ be such thatSn(α)⋆β is of the form defined in the question statement.\nWe have\nSn(α) ⋆ β=\nX\nk∈Z\nSn(α)(k)β(k) =\nX\nk∈Z\nα(k + n)β(k).\nWe can write\nPα(x) =\nX\nk∈Z\nα(k + n)xk+n = xn X\nk∈Z\nα(k + n)xk.\nFor a Laurent polynomialR and integerp, let[xp] R denote thexp coefficient inR. Using the above,\nwe can write\nSn(α) ⋆ β= [xn] Pα · Qβ =⇒ xk + xl =\nX\nn∈Z\nSn(α) ⋆ β= Pα(x)Qβ(x)\nwhere k and l are as in the condition in the problem statement.\nNote that multiplyingQ by a power ofx (which is the same as shiftingβ to the right) will just\nincrease the integers k and l (by the same amount). Thus, we can assume thatQβ is in fact a\npolynomial andk and l are non-negative integers.\nThe question now becomes how many polynomialsP of degree at most8 divide a polynomial of the\nform xk + xl for non-negative integers0 ≤ k < l. Settingb = l −k ≥ 1, this is equivalent to dividing\na polynomial of the form\nxa \u0000\nxb + 1\n\u0001\nfor non-negative integersa and b.\n20\nLetΦn(x) denote thenth cyclotomic polynomial which has integer coefficients and degreeφ(n) where\nφ is the Euler totient function. This is well-known to be irreducible and also we have\nxn − 1 =\nY\nd|n\nΦd(x).\nTherefore, we can write\nxa \u0000\nxb + 1\n\u0001\n= xa · x2b − 1\nxb − 1 = xa ·\nY\nd|2b , d∤b\nΦd(x).\nAs theΦd are all irreducible, a polynomialP will divide a polynomial of the above form if and only\nif it can be written as\nP(x) = ±xm Y\nd∈S\nΦd(x) (■)\nfor a non-negative integerm and a (possibly empty) setS which has the property that all its elements\nhave the same largest power of2 dividing them and that power is at least21 (to enable us to choose\na positive integern such thatS ⊂ {d : d|2n, d∤ n}). We will count the number of choices with a+\nsign and then double the count at the end to allow for the choices with a− sign. Note thatP is not\nidentically 0 so these choices of sign will yield different polynomials.\nClaim: φ(n) ≤ 8 if and only if1 ≤ n ≤ 10 or\nn ∈ {12, 14, 15, 16, 18, 20, 24, 30}.\nProof. It is easy to check all then in the given set giveφ(n) ≤ 8. Now, for contradiction, assume\nthere is a positive integern not on our list withφ(n) ≤ 8.\nIf n has at least three odd prime divisorsp1 < p2 < p3 then\nφ(n) ≥ (p1 − 1) (p2 − 1) (p3 − 1) ≥ (3 − 1)(5 − 1)(7 − 1) = 48 > 8.\nIf n has two odd prime divisorsp1 < p2 then ifp2 ≥ 7 we have\nφ(n) ≥ (p1 − 1) (p2 − 1) ≥ (3 − 1)(7 − 1) = 12 > 8.\nOtherwise, p1 = 3 and p2 = 5 so 15 | n. n ∈ {15, 30} are already on our list son/15 must be divisible\nby at least one of3, 4 or 5 which means\nφ(n) ≥ 2 · φ(n/15) ≥ 2(3 − 1)(5 − 1) = 16 > 8.\nIf n has one odd prime divisor, sayp with νp(n) = k for a positive integerk then\nφ(n) ≥ φ\n\u0000\npk\u0001\n= pk−1(p − 1) ≥ 2 · 3k−1.\nFork ≥ 3, this is> 8.\nFor k = 2, ifp ≥ 5, this is≥ 5 · (5 − 1) > 8 so the only possibility isp = 3. n ∈ {9, 18} are already\non our list son must be divisible by4 as well as9 which means\nφ(n) ≥ 2 · φ(9) = 2 · 6 > 8.\n21\nFork = 1, ifp ≥ 11 then we haveφ(n) ≥ p−1 > 8. Checking the remaining possibilitiesp ∈ {3, 5, 7}\nand noting that forφ(n), the largest power of2 dividing n is at most23, 22, and21, respectively,\nwe recover then already on our list.\nThe last case isn = 2α and since φ (2α) = 2 α−1, we requireα ≤ 4 for φ(n) ≤ 8 and we get the\nremaining n from our list.\nWe now split into cases based on the largest power of2 dividing elements ofS (which is the same\nfor all elements of S as noted above). To avoid double-counting across cases, we exclude the9\npolynomials corresponding toS empty (P(x) = 1, x, . . . , x8) and add these back in at the end.\nCase 1: All elements ofS are divisible by2 but not4\nFrom the Claim above, the only options fors ∈ S such thatφ(s) ≤ 8 are inS1 = {2, 6, 10, 14, 18, 30}.\nThis is in turn equal to\n8X\nt=0\n\u0002\nyt\u0003\n\"\n\u0000\n1 + y + ··· + y8\u0001\n·\n Y\ns∈S1\n\u0010\n1 + yφ(s)\n\u0011!#\n.\nHere the choice oft correspond to the degree ofP, the choice of a summand in(1 + y + ··· + y8)\ncorresponds to m in (■), and the choice of1 or yφ(s) in\n\u0000\n1 + yφ(s)\u0001\ncorresponds to whetherΦs(x)\nappears in the factorization ofP(x) (since deg Φs = φ(s)). For now we include the9 choices forP\nwhere S is empty and will exclude these at the end.\nExpanding the polynomial above, discarding terms of degree≥ 9 (denoted byO\n\u0000\ny9\u0001\n) we get\n··· =\n\u0000\n1 + y + ··· + y8\u0001\n(1 + y)\n\u0000\n1 + y2\u0001\u0000\n1 + y4\u0001\u0000\n1 + y6\u00012 \u0000\n1 + y8\u0001\n=\n\u0000\n1 + y + ··· + y8\u0001\u0000\n1 + y + y2 + y3\u0001\u0000\n1 + y4\u0001\u0000\n1 + 2y6 + y8\u0001\n+ O\n\u0000\ny9\u0001\n=\n\u0000\n1 + y + ··· + y8\u0001\u0000\n1 + y + y2 + y3\u0001\u0000\n1 + y4 + 2y6 + y8\u0001\n+ O\n\u0000\ny9\u0001\n=\n\u0000\n1 + y + ··· + y8\u0001\u0000\n1 + y + y2 + y3 + y4 + y5 + 3y6 + 3y7 + 3y8\u0001\n+ O\n\u0000\ny9\u0001\n.\nWe can then sum all coefficients of terms of degree≤ 8 to get\n9 + 8 + 7 + 6 + 5 + 4 + 3(3 + 2 + 1) = 57.\nWe must now subtract the9 polynomials that haveS empty giving57 − 9 = 48 possibilities forP\nfrom this case.\nCase 2: All elements ofS are divisible by4 but not8\nFrom the Claim above, the only options fors ∈ S such thatφ(s) ≤ 8 are inS2 = {4, 12, 20}. The\ndegrees ofΦs for s ∈ S2 is 2, 4, and8, respectively. To ensureP has degree at most8, we can choose\nS = {4}, {12}, {20}, {4, 12}\nwhich gives (counting the possibilities form of which there are9 minus the sum of the degrees of\nΦs since we can havem = 0)\n7 + 5 + 1 + 3 = 16\npossibilities forP.\n22\nCase 3: All elements ofS are divisible by8 but not16\nFrom the Claim, we must chooseS ⊂ {8, 24} and we haveφ(8) = 4, φ(24) = 8. S must therefore\nbe a singleton set and we get5 + 1 = 6 possibilities (counting the possibilities form as above).\nCase 4: All elements ofS are divisible by16 but not32\nIn this case we haveS = {16} giving a single possibility forP since φ(16) = 8 so m = 0.\nCombining the four cases and adding in the9 possibilities forP where S is empty, we get\n48 + 16 + 6 + 1 + 9 = 80\npossibilities for P with a positive leading coefficient. We then need to double this to allow for a\nnegative leading coefficient giving\n2 × 80 = 160\nchoices in total which is the answer we report.\n23\nProblem 10\nProblem: Let n ≥ 6 be a positive integer. We call a positive integern-Norwegian if it has three\ndistinct positive divisors whose sum is equal ton. Letf(n) denote the smallestn-Norwegian positive\ninteger. Let M = 32025! and for a non-negative integerc define\ng(c) = 1\n2025!\n\u00162025!f(M + c)\nM\n\u0017\n.\nWe can write\ng(0) + g(4M) + g(1848374) + g(10162574) + g(265710644) + g(44636594) = p\nq\nwhere p and q are coprime positive integers. What is the remainder whenp + q is divided by99991?\nAnswer: 8687\nSolution: In our solution to this problem, we include an extended commentary at the end that\nexplainshowwedesignproblemstoeffectivelyevaluateamodel’smathematicalunderstandingwithin\nthe constraints of an answer-only competition.\nLet N be n-Norwegian forn odd and write the three divisors ofN as\nn = N\np + N\nq + N\nr where 1 ≤ p < q < rand p, q, r| N.\nMinimising N is equivalent to maximising1\np + 1\nq + 1\nr subject to the resulting equation having an\ninteger solution forN with p, q, r| N. We will provide a classification of the minimalN for all n\nodd.\nWe first consider the case whenp = 1 and q = 2. We consider the possibilities forr based on whether\nit is odd and, in the even case, its remainder mod4.\nN = n · 2(2s + 1)\n6s + 5 (r = 2s + 1)\nN = n · 4s\n6s + 1 (r = 4s)\nN = n · 2s + 1\n3s + 2 (r = 4s + 2)\nNote in the last case, we haveN odd (since n and 2s + 1 are odd) soq = 2 ∤ N meaning this will\nnot give an integer solution forN.\nIn the first two cases, the fraction is written in lowest terms so the denominator must dividen.\nProvided this is satisfied, we haveq, r| N so this will yield a validN.\nThus, ifd1 and d5 are the smallest divisors ofn that are≥ 6 and are1 and 5 mod 6, respectively\nthen we have two candidates for minimalN from choosingd1 = 6s+ 1 or d5 = 6s+ 5 (since we want\nto minimiser which is equivalent to minimisings). These give the following values forN:\n2\n3 · d1 − 1\nd1\n· n or 2\n3 · d5 − 2\nd5\n· n. (▲)\nNow we turn our attention to the casep = 1 and q = 3. Working through the small cases:\n24\n• r = 4 gives N = 12n\n19 which forces19 | n. We get the same answer then by takingp = 1, q = 2,\nand r = 12 so this is already covered by the first case.\n• r = 5 gives N = 15n\n23 which forces23 | n. We get a smallerN = 14n\n23 by takingp = 1, q = 2,\nand r = 7 so this is already covered by the first case.\n• r = 6 gives N = 2n\n3 . For the divisibility conditionq, r| N to be satisfied, we require9 | n.\n• If r ≥ 7, then we have\nN = n · 3r\n4r + 3 = n\n\u00123\n4 − 9\n16r + 12\n\u0013\n≥ n\n\u00123\n4 − 9\n16 · 7 + 12\n\u0013\n= 21n\n31 > 2n\n3\nPutting the cases forq = 2 together with the case forq = 3 and r = 6, we have shown that ifn has\na divisor≥ 6 that is±1 mod 6 or if9 | n then we can find ann-Norwegian integer≤ 2n\n3 . For this\nnot to be the case, the only possibilities for prime factors of oddn are 3 and 5 and these must each\noccur with multiplicity1 (otherwise we could use52 ≡ 1 mod 6). Thus, the only oddn ≥ 6 that\ndoesn’t satisfy this condition isn = 15 and we can manually check that the minimum15-Norwegian\ninteger is12 (12 + 2 + 1 = 15).\nIn all other cases, we claim one of the cases we’ve covered is optimal. This is true because\n• We have already covered the cases forp = 1, q ∈ {2, 3} that giveN ≤ 2n\n3 .\n• If p = 1, q ≥ 4 then 1\np + 1\nq + 1\nr < 1 + 1\n4 + 1\n5 < 3\n2 so N >2n\n3 .\n• If p ≥ 2 then 1\np + 1\nq + 1\nr ≤ 1\n2 + 1\n3 + 1\n4 < 3\n2 so N >2n\n3 .\nDefine d1 and d5 to be equal to∞ if no such divisors ofn exist. Taking the optimal cases from what\nwe have considered above, we can write\nf(n) =\n\n\n\n12 if n = 15\nmin\nn\n2n\n3 , 2\n3 · d1−1\nd1\n· n, 2\n3 · d5−2\nd5\n· n\no\nif 9 | n\nmin\nn\n2\n3 · d1−1\nd1\n· n, 2\n3 · d5−2\nd5\n· n\no\notherwise\nwhere we have used that if9 ∤ n and n ̸= 15, thenn has at least one factor that is±1 mod 6 by a\nsimilar argument to the one used above.\nWe can further simplify this. If we definep1 and p5 to be the smallest prime divisors ofn that are\n≥ 7 and are1 and 5 mod 6, respectively (and setpi = ∞ if these don’t exist) then\nf(n) =\n\n\n\n12 if n = 15\n2n/3 if n = 3α, 5 · 3α for α ≥ 2\n16n/25 if 25 | n and p1 ≥ 31 and p5 ≥ 53\nmin\nn\n2\n3 · p1−1\np1\n· n, 2\n3 · p5−2\np5\n· n\no\notherwise\n(■)\nThe bounds in the third case come from considering first whend1 = 25. This will occur if and only\nif p1 > 25 which is the same asp1 ≥ 31 (the first prime that is1 mod 6 and greater than25). In\nthis case, settingd1 = 25 in (▲) gives\nN = 2\n3 · d1 − 1\nd1\n· n = 2\n3 · 25 − 1\n25 · n = 16\n25 · n.\n25\nWe then consider whend5 could give a smaller value ofN in (▲) which requires\n2\n3 · d5 − 2\nd5\n< 16\n25 ⇐⇒ d5 < 50.\nThis will happen if and only ifp5 < 50 (noting that125 > 50 so we cannot get a suitabled5 from\npowers of5). Thus, forN = 16n/25 to be optimal, we requirep5 ≥ 50 which is equivalent top5 ≥ 53\nas that is the smallest prime that is5 mod 6 and greater than or equal to50.\nWhen setting this question, we want to test that the models can produce a correct answer across a\nwide range of cases. This reduces the risk of a model simply getting the correct answer via crude\npattern spotting from small values ofn.\nFrom the classification in (■), there are at least six cases that we would want to test:\n(i) n = 3α for α ≥ 2;\n(ii) n = 5 · 3α for α ≥ 3 (there is little value in testing n = 15 since this falls to a direct\ncomputation);\n(iii) n = 25k where k has only ‘large’ prime divisors (so the third case holds);\n(iv) Case where25 | n but n is also divisible by a smaller prime so we move into the fourth case;\n(v) Case where the minimum is the first term in the fourth case;\n(vi) Case where the minimum is the second term in the fourth case (and we can create further\nchallenge by choosing an example wherep5 > p1).\nFor cases(iii) to (vi), we may be tempted to use factorials to ensure no small prime divisors eg ask\nfor f(2025! + 125). However, this suffers from the issue that this is also equal tof(125) so a model\ncould stumble on the correct answer by simply omitting the factorial term. Instead, we appeal to\nmodular arithmetic starting withM = 3 2025! which, by the Fermat–Euler Theorem, hasM ≡ 1\n(mod k) for k ≤ 2025 with gcd(k, 3) = 1 since φ(k) ≤ 2025 and henceφ(k) | 2025!.\nThus, for a positive integerc and positive integerk ≤ 2025 with gcd(k, 3) = 1, we have\nk | M + c ⇐⇒ k | 1 + c.\nAlso, since3 | M and 3 ∤ c, 3 ∤ M + c. The factors ofM + c that are≤ 2025 will therefore be the\nsame as the factors of1 +c. This allows us to calculate the ‘small’ factors ofn = M + c even though\nM is very large which in turn allows us to determine which case we fall into in (■).\nNow we selectn to cover each of the cases described above:\n(i) n = M — f(n) = 2n/3;\n(ii) n = 5M — f(n) = 2n/3;\n(iii) n = M + 1848374 (1 + 1848374 = 32 · 53 · 31 · 53) —f(n) = 16n/25;\n(iv) n = M + 10162574 (1 + 10162574 = 32 · 52 · 312 · 47) —f(n) = (2/3)(45/47)n;\n(v) n = M + 265710644 (1 + 265710644 = 33 · 5 · 97 · 103 · 197) —f(n) = (2/3)(96/97)n;\n197 − 2\n197 = 195\n197 > 96\n97 = 97 − 1\n97 .\n26\n(vi) n = M + 44636594 (1 + 44636594 = 3· 5 · 103 · 167 · 173) —f(n) = (2/3)(165/167)n.\n167 − 2\n167 = 165\n167 < 102\n103 = 103 − 1\n103 .\nAll models are allowed access to a calculator (and much more) which makes the factorisations\nstraightforward (this would still be possible for a human given the modest prime factors but this\nwould be somewhat arduous). We choose to keep the numbers large so even if the model has the idea\nof replacingM with 1, the cases are still challenging to compute directly.\nIn cases(iii) to (vi), the expressions are of the formf(M + c) = (s/t)(M + c) for positive integers\ns and t. Noting thatM ≫ c, M ≫ 2025! and t | 2025! we have\ng(c) = 1\n2025!\n\u00162025!f(M + c)\nM\n\u0017\n= 1\n2025!\n\u00162025!\nt · s + 2025!sc\ntM\n\u0017\n(0 < 2025!sc\ntM < 1)\n= 1\n2025! · 2025!\nt · s\n= s\nt .\nWe constructedg in the problem statement precisely to have this property of extracting the fraction\nin front ofn which is the ‘interesting’ part of the answer.\nIn cases(i) and (ii), we have\ng(0) = 1\n2025!\n\u00162025!f(M)\nM\n\u0017\n= 1\n2025!\n\u00162025!(2M/3)\nM\n\u0017\n= 1\n2025!\n\u00162 · 2025!\n3\n\u0017\n= 1\n2025! · 2 · 2025!\n3 = 2\n3\ng(4M) = 1\n2025!\n\u00162025!f(5M)\nM\n\u0017\n= 1\n2025!\n\u00162025!(10M/3)\nM\n\u0017\n= 1\n2025!\n\u001610 · 2025!\n3\n\u0017\n= 1\n2025! · 10 · 2025!\n3 = 10\n3 .\nPutting this all together,\ng(0) + g(4M) + g(1848374) + g(10162574) + g(265710644) + g(44636594)\n= 2\n3 + 10\n3 + 16\n25 + 2\n3 · 45\n47 + 2\n3 · 96\n97 + 2\n3 · 165\n167\n= 125561848\n19033825 .\nWe then have\np = 125,561,848 , q= 19,033,825 =⇒ p + q = 144,595,673 ≡ 8687 (mod 99991)\nwhich is the answer we report.\n27\nRemark1: ThisproblemwasadaptedfromProblemN1ofthe International Mathematical Olympiad\n(IMO) Shortlist 2022which can be found here. The original version simply asked forf(2022).\nAll problems used in AIMO3 are entirely original; this adaptation is included solely to illustrate\nthe process behind designing a challenging problem within the answer-only format. We reserve our\noriginal hard problems for the public and private Kaggle leaderboards, given the significant effort\ninvolved in creating them. The original problem itself is unsuitable for an answer-only setting, as\nit can be solved directly by enumerating possible positive integers and their divisor sums, leading\nstraightforwardly to the correct answer of1344.\nRemark 2: Careful examination of the official solution provided in the shortlist reveals that it\nultimately depends on expressing2022 as 6(6k + 1), where6k + 1 is prime. The answer is then24k\n(with 24k + 12k + 6 = 6(6 k + 1)). Motivated by this, a simpler reformulation that removes any\nstraightforward computational path is:\nProblem: p = 2 ·330 + 1 is prime. A positive integer is called Norwegian if it has three distinct\npositive divisors whose sum is equal to6p. Let N be the smallest Norwegian positive integer.\nWhat is the remainder whenN is divided by99991?\nAnswer: 15245\nHowever, this version tests only a single family of values forf(n). A model might still conjecture a\npattern by examining smaller primes, though this is complicated by the differing answers depending\non whetherp ≡ ±1 mod 6. The final version of the problem in the reference set generalises across\na broader range of cases, making it extremely difficult to identify a solution pattern even from\nextensive numerical experimentation.\n28", "expected": null}
